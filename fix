PS C:\Users\aa-vnasta-som> C:\Scripts\Debug-Security-Assessment.ps1
=== DEBUG: Security Assessment Loading ===

Checking Global Variables:
- Global:Config exists: True
- Global:OutputPath: C:\AD_Assessment
- Global:LogFile: C:\AD_Assessment\AD_Assessment_Log_20250619_095256.txt
- Output directory exists: False

Manually loading core script...
Core script found at: C:\Scripts\00-AD-Assessment-Core.ps1
Initializing Enhanced AD Assessment Core Infrastructure...
Script version timestamp: 2025-06-19 10:22:11
Auto-detecting organizational settings via ADSI...
Auto-detected inactive user threshold: 42 days
Auto-detected stale password threshold: 84 days
Detected domain functional level: 7
Checking output directory: C:\AD_Assessment
Output directory does not exist. Attempting to create...
Output directory created successfully at: C:\AD_Assessment
Initializing log file: C:\AD_Assessment\AD_Assessment_Log_20250619_102211.txt
Log file initialized successfully

Configuration Summary:
- Inactive User Threshold: 42 days
- Inactive Computer Threshold: 90 days
- Stale Password Threshold: 84 days
- Output Directory: C:\AD_Assessment
- Log File: C:\AD_Assessment\AD_Assessment_Log_20250619_102211.txt
- Using ADSI (No AD Module Required)

2025-06-19 10:22:11 - Enhanced AD Assessment Core Infrastructure Initialized
2025-06-19 10:22:11 - Configuration: Inactive Users: 42d, Inactive Computers: 90d
2025-06-19 10:22:11 - ADSI-based implementation - No AD Module or WinRM dependencies
ADSI connectivity verified - Domain: som
2025-06-19 10:22:11 - ADSI connectivity verified - Domain: som
Core infrastructure ready. Run individual assessment scripts.

After loading core script:
- Global:OutputPath: C:\AD_Assessment
- Output directory exists: True

=== END DEBUG ===
PS C:\Users\aa-vnasta-som>
